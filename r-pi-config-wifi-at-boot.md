# configure wifi at boot time


### Board:  RPI-2

### KERNEL 

```
marius@rtsp1:~ $ uname -a
Linux rtsp1.local 4.14.71-v7+ #1145 SMP Fri Sep 21 15:38:35 BST 2018 armv7l GNU/Linux
marius@rtsp1:~ $ cat /etc/debian_version 
9.4
```

### WPA_SUPLICANT
```
marius@rtsp1:~ $ ps ax |grep wpa
  331 ?        Ss     0:00 /sbin/wpa_supplicant -s -B -P /run/wpa_supplicant.wlan0.pid -i wlan0 -D nl80211,wext -C /run/wpa_supplicant
 2928 pts/0    S+     0:00 grep --color=auto wpa
```

### wpa_suppliant.service

```
marius@rtsp1:~ $ cat /lib/systemd/system/wpa_supplicant.service 
[Unit]
Description=WPA supplicant
Before=network.target
After=dbus.service
Wants=network.target

[Service]
Type=dbus
BusName=fi.epitest.hostap.WPASupplicant
ExecStart=/sbin/wpa_supplicant -u -s -O /run/wpa_supplicant

[Install]
WantedBy=multi-user.target
Alias=dbus-fi.epitest.hostap.WPASupplicant.service

```

### wpa-suppliant.conf
```
marius@rtsp1:~ $ cat /etc/wpa_supplicant/wpa_supplicant.conf 
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
country=CA
##
##  generated by wpa_passphrase ssid passwprd
##
network={
	ssid="marius"
	psk=2a32a6948335e3bda88dea475ddf7f36a8ba4de0aec72be1bf00e55d592cf4fe
}


### etc/network/interfaces

```
marius@rtsp1:~ $ cat /etc/network/interfaces
source-directory /etc/network/interfaces.d

auto l0
iface lo inet loopback

auto eth0
	iface eth0 inet dhcp

allow-hotplug wlan0
auto wlan0
	iface wlan0 inet manual # dhcp
	wpa-ssid myssid
	wpa-psk mypassword
	wireless-power off


# a startup script 
```
#!/bin/bash
sleep 20
ifconfig wlan0 down
sleep 5
ifconfig wlan0 up
dhclient wlan0
```


